{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{io}from'socket.io-client';import{useAuth}from'./AuthContext';import toast from'react-hot-toast';import{jsx as _jsx}from\"react/jsx-runtime\";const SocketContext=/*#__PURE__*/createContext();export const SocketProvider=_ref=>{let{children}=_ref;const[socket,setSocket]=useState(null);const[isConnected,setIsConnected]=useState(false);const[notifications,setNotifications]=useState([]);const{user,isAuthenticated}=useAuth();useEffect(()=>{if(isAuthenticated&&user){const newSocket=io(process.env.REACT_APP_SOCKET_URL||'http://localhost:5000',{auth:{token:localStorage.getItem('token')}});newSocket.on('connect',()=>{console.log('Connected to socket server');setIsConnected(true);});newSocket.on('disconnect',()=>{console.log('Disconnected from socket server');setIsConnected(false);});newSocket.on('message',data=>{// Handle new message\ntoast.success(\"New message from \".concat(data.sender.firstName));setNotifications(prev=>[...prev,{type:'message',data}]);});newSocket.on('referral_request',data=>{// Handle new referral request\ntoast.success(\"New referral request from \".concat(data.student.firstName));setNotifications(prev=>[...prev,{type:'referral',data}]);});newSocket.on('referral_response',data=>{// Handle referral response\nconst status=data.status==='accepted'?'accepted':'declined';toast.success(\"Your referral request was \".concat(status));setNotifications(prev=>[...prev,{type:'referral_response',data}]);});newSocket.on('connection_request',data=>{// Handle connection request\ntoast.success(\"New connection request from \".concat(data.from.firstName));setNotifications(prev=>[...prev,{type:'connection',data}]);});newSocket.on('post_like',data=>{// Handle post like\ntoast.success(\"\".concat(data.user.firstName,\" liked your post\"));setNotifications(prev=>[...prev,{type:'like',data}]);});newSocket.on('post_comment',data=>{// Handle post comment\ntoast.success(\"\".concat(data.user.firstName,\" commented on your post\"));setNotifications(prev=>[...prev,{type:'comment',data}]);});newSocket.on('error',error=>{console.error('Socket error:',error);toast.error('Connection error. Please refresh the page.');});setSocket(newSocket);return()=>{newSocket.close();};}},[isAuthenticated,user]);// Send message\nconst sendMessage=(conversationId,message)=>{if(socket&&isConnected){socket.emit('send_message',{conversationId,message});}};// Join conversation\nconst joinConversation=conversationId=>{if(socket&&isConnected){socket.emit('join_conversation',{conversationId});}};// Leave conversation\nconst leaveConversation=conversationId=>{if(socket&&isConnected){socket.emit('leave_conversation',{conversationId});}};// Mark message as read\nconst markMessageAsRead=(conversationId,messageId)=>{if(socket&&isConnected){socket.emit('mark_read',{conversationId,messageId});}};// Clear notifications\nconst clearNotifications=()=>{setNotifications([]);};// Remove specific notification\nconst removeNotification=index=>{setNotifications(prev=>prev.filter((_,i)=>i!==index));};const value={socket,isConnected,notifications,sendMessage,joinConversation,leaveConversation,markMessageAsRead,clearNotifications,removeNotification};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:value,children:children});};export const useSocket=()=>{const context=useContext(SocketContext);if(!context){throw new Error('useSocket must be used within a SocketProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","io","useAuth","toast","jsx","_jsx","SocketContext","SocketProvider","_ref","children","socket","setSocket","isConnected","setIsConnected","notifications","setNotifications","user","isAuthenticated","newSocket","process","env","REACT_APP_SOCKET_URL","auth","token","localStorage","getItem","on","console","log","data","success","concat","sender","firstName","prev","type","student","status","from","error","close","sendMessage","conversationId","message","emit","joinConversation","leaveConversation","markMessageAsRead","messageId","clearNotifications","removeNotification","index","filter","_","i","value","Provider","useSocket","context","Error"],"sources":["/Users/anjaliprajapati/ConnectNITA/Connect-NITA/Frontend/src/contexts/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { io } from 'socket.io-client';\nimport { useAuth } from './AuthContext';\nimport toast from 'react-hot-toast';\n\nconst SocketContext = createContext();\n\nexport const SocketProvider = ({ children }) => {\n  const [socket, setSocket] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [notifications, setNotifications] = useState([]);\n  const { user, isAuthenticated } = useAuth();\n\n  useEffect(() => {\n    if (isAuthenticated && user) {\n      const newSocket = io(process.env.REACT_APP_SOCKET_URL || 'http://localhost:5000', {\n        auth: {\n          token: localStorage.getItem('token'),\n        },\n      });\n\n      newSocket.on('connect', () => {\n        console.log('Connected to socket server');\n        setIsConnected(true);\n      });\n\n      newSocket.on('disconnect', () => {\n        console.log('Disconnected from socket server');\n        setIsConnected(false);\n      });\n\n      newSocket.on('message', (data) => {\n        // Handle new message\n        toast.success(`New message from ${data.sender.firstName}`);\n        setNotifications(prev => [...prev, { type: 'message', data }]);\n      });\n\n      newSocket.on('referral_request', (data) => {\n        // Handle new referral request\n        toast.success(`New referral request from ${data.student.firstName}`);\n        setNotifications(prev => [...prev, { type: 'referral', data }]);\n      });\n\n      newSocket.on('referral_response', (data) => {\n        // Handle referral response\n        const status = data.status === 'accepted' ? 'accepted' : 'declined';\n        toast.success(`Your referral request was ${status}`);\n        setNotifications(prev => [...prev, { type: 'referral_response', data }]);\n      });\n\n      newSocket.on('connection_request', (data) => {\n        // Handle connection request\n        toast.success(`New connection request from ${data.from.firstName}`);\n        setNotifications(prev => [...prev, { type: 'connection', data }]);\n      });\n\n      newSocket.on('post_like', (data) => {\n        // Handle post like\n        toast.success(`${data.user.firstName} liked your post`);\n        setNotifications(prev => [...prev, { type: 'like', data }]);\n      });\n\n      newSocket.on('post_comment', (data) => {\n        // Handle post comment\n        toast.success(`${data.user.firstName} commented on your post`);\n        setNotifications(prev => [...prev, { type: 'comment', data }]);\n      });\n\n      newSocket.on('error', (error) => {\n        console.error('Socket error:', error);\n        toast.error('Connection error. Please refresh the page.');\n      });\n\n      setSocket(newSocket);\n\n      return () => {\n        newSocket.close();\n      };\n    }\n  }, [isAuthenticated, user]);\n\n  // Send message\n  const sendMessage = (conversationId, message) => {\n    if (socket && isConnected) {\n      socket.emit('send_message', { conversationId, message });\n    }\n  };\n\n  // Join conversation\n  const joinConversation = (conversationId) => {\n    if (socket && isConnected) {\n      socket.emit('join_conversation', { conversationId });\n    }\n  };\n\n  // Leave conversation\n  const leaveConversation = (conversationId) => {\n    if (socket && isConnected) {\n      socket.emit('leave_conversation', { conversationId });\n    }\n  };\n\n  // Mark message as read\n  const markMessageAsRead = (conversationId, messageId) => {\n    if (socket && isConnected) {\n      socket.emit('mark_read', { conversationId, messageId });\n    }\n  };\n\n  // Clear notifications\n  const clearNotifications = () => {\n    setNotifications([]);\n  };\n\n  // Remove specific notification\n  const removeNotification = (index) => {\n    setNotifications(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const value = {\n    socket,\n    isConnected,\n    notifications,\n    sendMessage,\n    joinConversation,\n    leaveConversation,\n    markMessageAsRead,\n    clearNotifications,\n    removeNotification,\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n\nexport const useSocket = () => {\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocket must be used within a SocketProvider');\n  }\n  return context;\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}